/*
 * Copyright (c) 2020. University of Canterbury
 *
 * This file is part of SENG301 lab material.
 *
 *  The lab material is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Lesser General Public License as published
 *  by the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  The lab material is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Lesser General Public License for more details.
 *
 *  You should have received a copy of the GNU Lesser General Public License
 *  along with this material.  If not, see <https://www.gnu.org/licenses/>.
 */

/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.2.2/userguide/tutorial_java_projects.html
 *
 * Updated by fgi18 on 25 Mar. 2020
 */

plugins {
    // Apply the java plugin to add support for Java
    id 'java'

    // Apply the application plugin to add support for building a CLI application.
    id 'application'
}

repositories {
    mavenCentral()
}

dependencies {
    // unit testing (aka SENG201)
    testImplementation 'junit:junit:4.12'

    // databases (SENG301 lab 1)
    compile group: 'org.xerial', name: 'sqlite-jdbc', version: '3.28.0'
    compile group: 'org.hibernate', name: 'hibernate-core', version: '5.4.12.Final'
    compile group: 'com.zsoltfabok', name: 'sqlite-dialect', version: '1.0'

    // acceptance testing (SENG301 lab 4)
    testImplementation 'io.cucumber:cucumber-java:5.4.0'
    testImplementation 'io.cucumber:cucumber-junit:5.4.0'

    // acceptance testing (SENG301 lab 5)
    implementation group: 'org.mockito', name: 'mockito-core', version: '3.2.0'

    // logging facility (SENG301 lecture 8)
    compile group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.13.1'

    runtime("com.h2database:h2:1.3.176")
}

application {
    // Define the main class for the application.
    mainClassName = 'uc.seng301.asg1.App'
}

test {
    useJUnit()
}

configurations {
    cucumberRuntime {
        extendsFrom testImplementation
    }
}

run{
    // this is needed if you want to start your main class with gradle run
    // you may also pass the --console=PLAIN option to disable the green progress bar
    // e.g., gradle --console=PLAIN run
    standardInput = System.in
}

task cucumber() {
    dependsOn assemble, compileTestJava
    doLast {
        javaexec {
            main = "io.cucumber.core.cli.Main"
            classpath = configurations.cucumberRuntime + sourceSets.main.output + sourceSets.test.output
            args = ['--plugin', 'pretty', '--glue', 'gradle.cucumber', 'src/test/resources', '--snippets', 'camelcase']
        }
    }
}